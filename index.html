<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calcula tu huella de carbono semanal</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-emerald-50 text-stone-800 font-sans min-h-screen flex flex-col items-center p-6">
  <header class="text-center mb-6">
    <h1 class="text-3xl font-bold text-emerald-800 mb-2">üåç Calcula tu huella de carbono semanal</h1>
    <p class="text-stone-700 max-w-2xl">
      Registra tus h√°bitos d√≠a a d√≠a, observa tu impacto acumulado y guarda tus semanas para comparar tu progreso sostenible.
    </p>
  </header>

  <main class="w-full max-w-5xl bg-white shadow-lg rounded-2xl p-6 border border-emerald-100">
    <section class="mb-6 text-stone-700">
      <p><strong>Instrucciones:</strong> Completa solo los d√≠as que ya han transcurrido.  
      La app calcular√° autom√°ticamente tu huella parcial o total. Puedes guardar tus resultados al final de la semana.</p>
    </section>

    <div class="overflow-x-auto">
      <table class="w-full border border-emerald-100 text-sm text-center">
        <thead class="bg-emerald-100 text-emerald-900">
          <tr>
            <th class="p-2">D√≠a</th>
            <th class="p-2">üçΩÔ∏è Alimentaci√≥n</th>
            <th class="p-2">üöó Transporte</th>
            <th class="p-2">üöø Ducha</th>
            <th class="p-2">Huella (kg CO‚ÇÇ)</th>
          </tr>
        </thead>
        <tbody id="weekBody" class="text-stone-700 bg-white">
        </tbody>
      </table>
    </div>

    <div class="flex justify-between mt-6">
      <button onclick="calculateWeek()" class="bg-emerald-700 hover:bg-emerald-800 text-white px-4 py-2 rounded-lg shadow">
        Calcular huella semanal
      </button>
      <button onclick="saveWeek()" class="bg-lime-700 hover:bg-lime-800 text-white px-4 py-2 rounded-lg shadow">
        Guardar semana
      </button>
      <button onclick="resetWeek()" class="bg-stone-300 hover:bg-stone-400 text-stone-800 px-4 py-2 rounded-lg shadow">
        Reiniciar semana
      </button>
    </div>

    <section id="result" class="mt-6 hidden">
      <h2 class="text-xl font-semibold text-emerald-800 mb-2">üå± Resultado de la semana</h2>
      <p id="carbonOutput" class="text-stone-700 mb-3"></p>
      <button onclick="generateTips()" class="bg-lime-600 hover:bg-lime-700 text-white px-4 py-2 rounded-lg shadow">
        Generar consejos sostenibles
      </button>
      <ul id="tipsList" class="mt-3 list-disc pl-5 text-stone-700"></ul>
    </section>

    <section class="mt-8 bg-emerald-50 border-t-2 border-emerald-200 pt-4 text-sm text-stone-600">
      <h3 class="font-semibold text-emerald-800 mb-1">üìä M√©todo de c√°lculo</h3>
      <p>Las emisiones se estiman seg√∫n datos medios del <strong>IPCC</strong> y la <strong>FAO</strong> sobre consumo energ√©tico, transporte y dieta.  
      Los valores aproximan <em>kg de CO‚ÇÇ equivalentes por d√≠a</em>.</p>
    </section>

    <section class="mt-8">
      <h3 class="text-lg font-semibold text-emerald-800 mb-2">üìÅ Semanas guardadas</h3>
      <div id="savedWeeks" class="space-y-2 text-stone-700"></div>
    </section>
  </main>

  <footer class="mt-6 text-xs text-stone-500">
    Desarrollado con prop√≥sito sostenible ‚ôªÔ∏è
  </footer>

  <script>
    const days = ["Lunes","Martes","Mi√©rcoles","Jueves","Viernes","S√°bado","Domingo"];
    const weekBody = document.getElementById("weekBody");

    function createTable() {
      weekBody.innerHTML = "";
      days.forEach((day, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="border p-2 font-semibold bg-emerald-50">${day}</td>
          <td class="border p-2">
            <select id="food-${i}" class="w-full p-1 border rounded">
              <option value="">-</option>
              <option value="0.5">Cocinada en casa</option>
              <option value="1.0">Comida empacada/procesada</option>
              <option value="1.5">Comida r√°pida o carne roja</option>
            </select>
          </td>
          <td class="border p-2">
            <select id="transport-${i}" class="w-full p-1 border rounded">
              <option value="">-</option>
              <option value="0.2">Caminata o bicicleta</option>
              <option value="0.5">Mixta (p√∫blico + caminata)</option>
              <option value="0.6">Transporte p√∫blico</option>
              <option value="1.2">Coche propio</option>
              <option value="0">Teletrabajo</option>
            </select>
          </td>
          <td class="border p-2">
            <select id="shower-${i}" class="w-full p-1 border rounded">
              <option value="">-</option>
              <option value="0.2">Menos de 5 min</option>
              <option value="0.5">5-10 min</option>
              <option value="0.8">M√°s de 10 min</option>
            </select>
          </td>
          <td class="border p-2 text-stone-700" id="total-${i}">-</td>
        `;
        weekBody.appendChild(row);
      });
      loadCurrentWeek();
      showSavedWeeks();
    }

    function calculateWeek() {
      let totalWeek = 0;
      days.forEach((_, i) => {
        const food = parseFloat(document.getElementById(`food-${i}`).value) || 0;
        const transport = parseFloat(document.getElementById(`transport-${i}`).value) || 0;
        const shower = parseFloat(document.getElementById(`shower-${i}`).value) || 0;
        const dayTotal = food + transport + shower;
        document.getElementById(`total-${i}`).textContent = dayTotal > 0 ? dayTotal.toFixed(2) : "-";
        totalWeek += dayTotal;
      });
      localStorage.setItem("currentWeek", JSON.stringify(getWeekData()));
      const result = document.getElementById("result");
      const output = document.getElementById("carbonOutput");
      output.innerHTML = `Tu huella total acumulada esta semana es de <strong>${totalWeek.toFixed(2)} kg de CO‚ÇÇ</strong>.`;
      result.classList.remove("hidden");
      document.getElementById("tipsList").innerHTML = "";
    }

    function getWeekData() {
      return days.map((_, i) => ({
        food: document.getElementById(`food-${i}`).value,
        transport: document.getElementById(`transport-${i}`).value,
        shower: document.getElementById(`shower-${i}`).value
      }));
    }

    function loadCurrentWeek() {
      const saved = localStorage.getItem("currentWeek");
      if (!saved) return;
      const data = JSON.parse(saved);
      data.forEach((d, i) => {
        if (d.food) document.getElementById(`food-${i}`).value = d.food;
        if (d.transport) document.getElementById(`transport-${i}`).value = d.transport;
        if (d.shower) document.getElementById(`shower-${i}`).value = d.shower;
      });
    }

    function saveWeek() {
      const name = prompt("Asigna un nombre a esta semana (por ejemplo: Semana 1 Ricardo):");
      if (!name) return;
      const data = getWeekData();
      localStorage.setItem(`week_${name}`, JSON.stringify(data));
      localStorage.removeItem("currentWeek");
      alert("Semana guardada correctamente.");
      showSavedWeeks();
      resetWeek();
    }

    function showSavedWeeks() {
      const container = document.getElementById("savedWeeks");
      container.innerHTML = "";
      Object.keys(localStorage).forEach(k => {
        if (k.startsWith("week_")) {
          const btn = document.createElement("button");
          btn.textContent = k.replace("week_", "");
          btn.className = "block bg-emerald-100 hover:bg-emerald-200 px-3 py-1 rounded text-emerald-800";
          btn.onclick = () => loadSavedWeek(k);
          container.appendChild(btn);
        }
      });
    }

    function loadSavedWeek(key) {
      const data = JSON.parse(localStorage.getItem(key));
      data.forEach((d, i) => {
        document.getElementById(`food-${i}`).value = d.food || "";
        document.getElementById(`transport-${i}`).value = d.transport || "";
        document.getElementById(`shower-${i}`).value = d.shower || "";
      });
      calculateWeek();
      alert(`Semana "${key.replace("week_", "")}" cargada.`);
    }

    function resetWeek() {
      localStorage.removeItem("currentWeek");
      createTable();
      document.getElementById("result").classList.add("hidden");
    }

    function generateTips() {
      const tips = [
        "Prefiere alimentos locales y de temporada.",
        "Reduce el consumo de carne roja y comida procesada.",
        "Usa transporte p√∫blico o combina con caminatas.",
        "Toma duchas de menos de 5 minutos.",
        "Evita pl√°sticos de un solo uso y recicla.",
        "Desconecta aparatos que no utilices."
      ];
      const tipsList = document.getElementById("tipsList");
      tipsList.innerHTML = "";
      tips.sort(() => 0.5 - Math.random()).slice(0, 3).forEach(t => {
        const li = document.createElement("li");
        li.textContent = t;
        tipsList.appendChild(li);
      });
    }

    createTable();
  </script>
</body>
</html>
